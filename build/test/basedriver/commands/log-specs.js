"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
require("source-map-support/register");
var _log = _interopRequireDefault(require("../../../lib/basedriver/commands/log"));
var _chai = _interopRequireDefault(require("chai"));
var _chaiAsPromised = _interopRequireDefault(require("chai-as-promised"));
var _sinon = _interopRequireDefault(require("sinon"));
var _lodash = _interopRequireDefault(require("lodash"));
_chai.default.should();
_chai.default.use(_chaiAsPromised.default);
const expect = _chai.default.expect;
const FIRST_LOGS = ['first', 'logs'];
const SECOND_LOGS = ['second', 'logs'];
const SUPPORTED_LOG_TYPES = {
  one: {
    description: 'First logs',
    getter: () => _lodash.default.clone(FIRST_LOGS)
  },
  two: {
    description: 'Seconds logs',
    getter: () => _lodash.default.clone(SECOND_LOGS)
  }
};
describe('log commands -', function () {
  beforeEach(function () {
    _log.default.supportedLogTypes = {};
  });
  describe('getLogTypes', function () {
    it('should return empty array when no supported log types', async function () {
      (await _log.default.getLogTypes()).should.eql([]);
    });
    it('should return keys to log type object', async function () {
      _log.default.supportedLogTypes = SUPPORTED_LOG_TYPES;
      (await _log.default.getLogTypes()).should.eql(['one', 'two']);
    });
  });
  describe('getLog', function () {
    beforeEach(function () {
      _sinon.default.spy(SUPPORTED_LOG_TYPES.one, 'getter');
      _sinon.default.spy(SUPPORTED_LOG_TYPES.two, 'getter');
    });
    afterEach(function () {
      SUPPORTED_LOG_TYPES.one.getter.restore();
      SUPPORTED_LOG_TYPES.two.getter.restore();
    });
    it('should throw error if log type not supported', async function () {
      await _log.default.getLog('one').should.eventually.be.rejected;
      SUPPORTED_LOG_TYPES.one.getter.called.should.be.false;
      SUPPORTED_LOG_TYPES.two.getter.called.should.be.false;
    });
    it('should throw an error with available log types if log type not supported', async function () {
      _log.default.supportedLogTypes = SUPPORTED_LOG_TYPES;
      let err;
      try {
        await _log.default.getLog('three');
      } catch (_err) {
        err = _err;
      }
      expect(err).to.exist;
      err.message.should.eql(`Unsupported log type 'three'. Supported types: {"one":"First logs","two":"Seconds logs"}`);
      SUPPORTED_LOG_TYPES.one.getter.called.should.be.false;
      SUPPORTED_LOG_TYPES.two.getter.called.should.be.false;
    });
    it('should call getter on appropriate log when found', async function () {
      _log.default.supportedLogTypes = SUPPORTED_LOG_TYPES;
      let logs = await _log.default.getLog('one');
      logs.should.eql(FIRST_LOGS);
      SUPPORTED_LOG_TYPES.one.getter.called.should.be.true;
      SUPPORTED_LOG_TYPES.two.getter.called.should.be.false;
    });
  });
});require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVzdC9iYXNlZHJpdmVyL2NvbW1hbmRzL2xvZy1zcGVjcy5qcyIsIm5hbWVzIjpbIl9sb2ciLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9jaGFpIiwiX2NoYWlBc1Byb21pc2VkIiwiX3Npbm9uIiwiX2xvZGFzaCIsImNoYWkiLCJzaG91bGQiLCJ1c2UiLCJjaGFpQXNQcm9taXNlZCIsImV4cGVjdCIsIkZJUlNUX0xPR1MiLCJTRUNPTkRfTE9HUyIsIlNVUFBPUlRFRF9MT0dfVFlQRVMiLCJvbmUiLCJkZXNjcmlwdGlvbiIsImdldHRlciIsIl8iLCJjbG9uZSIsInR3byIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsImxvZ0NvbW1hbmRzIiwic3VwcG9ydGVkTG9nVHlwZXMiLCJpdCIsImdldExvZ1R5cGVzIiwiZXFsIiwic2lub24iLCJzcHkiLCJhZnRlckVhY2giLCJyZXN0b3JlIiwiZ2V0TG9nIiwiZXZlbnR1YWxseSIsImJlIiwicmVqZWN0ZWQiLCJjYWxsZWQiLCJmYWxzZSIsImVyciIsIl9lcnIiLCJ0byIsImV4aXN0IiwibWVzc2FnZSIsImxvZ3MiLCJ0cnVlIl0sInNvdXJjZVJvb3QiOiIuLi8uLi8uLi8uLiIsInNvdXJjZXMiOlsidGVzdC9iYXNlZHJpdmVyL2NvbW1hbmRzL2xvZy1zcGVjcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbmltcG9ydCBsb2dDb21tYW5kcyBmcm9tICcuLi8uLi8uLi9saWIvYmFzZWRyaXZlci9jb21tYW5kcy9sb2cnO1xuaW1wb3J0IGNoYWkgZnJvbSAnY2hhaSc7XG5pbXBvcnQgY2hhaUFzUHJvbWlzZWQgZnJvbSAnY2hhaS1hcy1wcm9taXNlZCc7XG5pbXBvcnQgc2lub24gZnJvbSAnc2lub24nO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcblxuXG5jaGFpLnNob3VsZCgpO1xuY2hhaS51c2UoY2hhaUFzUHJvbWlzZWQpO1xuY29uc3QgZXhwZWN0ID0gY2hhaS5leHBlY3Q7XG5cbmNvbnN0IEZJUlNUX0xPR1MgPSBbJ2ZpcnN0JywgJ2xvZ3MnXTtcbmNvbnN0IFNFQ09ORF9MT0dTID0gWydzZWNvbmQnLCAnbG9ncyddO1xuY29uc3QgU1VQUE9SVEVEX0xPR19UWVBFUyA9IHtcbiAgb25lOiB7XG4gICAgZGVzY3JpcHRpb246ICdGaXJzdCBsb2dzJyxcbiAgICBnZXR0ZXI6ICgpID0+IF8uY2xvbmUoRklSU1RfTE9HUyksXG4gIH0sXG4gIHR3bzoge1xuICAgIGRlc2NyaXB0aW9uOiAnU2Vjb25kcyBsb2dzJyxcbiAgICBnZXR0ZXI6ICgpID0+IF8uY2xvbmUoU0VDT05EX0xPR1MpLFxuICB9LFxufTtcblxuZGVzY3JpYmUoJ2xvZyBjb21tYW5kcyAtJywgZnVuY3Rpb24gKCkge1xuICBiZWZvcmVFYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAvLyByZXNldCB0aGUgc3VwcG9ydGVkIGxvZyB0eXBlc1xuICAgIGxvZ0NvbW1hbmRzLnN1cHBvcnRlZExvZ1R5cGVzID0ge307XG4gIH0pO1xuICBkZXNjcmliZSgnZ2V0TG9nVHlwZXMnLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1wdHkgYXJyYXkgd2hlbiBubyBzdXBwb3J0ZWQgbG9nIHR5cGVzJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgKGF3YWl0IGxvZ0NvbW1hbmRzLmdldExvZ1R5cGVzKCkpLnNob3VsZC5lcWwoW10pO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGtleXMgdG8gbG9nIHR5cGUgb2JqZWN0JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgbG9nQ29tbWFuZHMuc3VwcG9ydGVkTG9nVHlwZXMgPSBTVVBQT1JURURfTE9HX1RZUEVTO1xuICAgICAgKGF3YWl0IGxvZ0NvbW1hbmRzLmdldExvZ1R5cGVzKCkpLnNob3VsZC5lcWwoWydvbmUnLCAndHdvJ10pO1xuICAgIH0pO1xuICB9KTtcbiAgZGVzY3JpYmUoJ2dldExvZycsIGZ1bmN0aW9uICgpIHtcbiAgICBiZWZvcmVFYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIHNpbm9uLnNweShTVVBQT1JURURfTE9HX1RZUEVTLm9uZSwgJ2dldHRlcicpO1xuICAgICAgc2lub24uc3B5KFNVUFBPUlRFRF9MT0dfVFlQRVMudHdvLCAnZ2V0dGVyJyk7XG4gICAgfSk7XG4gICAgYWZ0ZXJFYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIFNVUFBPUlRFRF9MT0dfVFlQRVMub25lLmdldHRlci5yZXN0b3JlKCk7XG4gICAgICBTVVBQT1JURURfTE9HX1RZUEVTLnR3by5nZXR0ZXIucmVzdG9yZSgpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3IgaWYgbG9nIHR5cGUgbm90IHN1cHBvcnRlZCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGF3YWl0IGxvZ0NvbW1hbmRzLmdldExvZygnb25lJykuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWQ7XG4gICAgICBTVVBQT1JURURfTE9HX1RZUEVTLm9uZS5nZXR0ZXIuY2FsbGVkLnNob3VsZC5iZS5mYWxzZTtcbiAgICAgIFNVUFBPUlRFRF9MT0dfVFlQRVMudHdvLmdldHRlci5jYWxsZWQuc2hvdWxkLmJlLmZhbHNlO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgdGhyb3cgYW4gZXJyb3Igd2l0aCBhdmFpbGFibGUgbG9nIHR5cGVzIGlmIGxvZyB0eXBlIG5vdCBzdXBwb3J0ZWQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsb2dDb21tYW5kcy5zdXBwb3J0ZWRMb2dUeXBlcyA9IFNVUFBPUlRFRF9MT0dfVFlQRVM7XG4gICAgICBsZXQgZXJyO1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgbG9nQ29tbWFuZHMuZ2V0TG9nKCd0aHJlZScpO1xuICAgICAgfSBjYXRjaCAoX2Vycikge1xuICAgICAgICBlcnIgPSBfZXJyO1xuICAgICAgfVxuICAgICAgZXhwZWN0KGVycikudG8uZXhpc3Q7XG4gICAgICBlcnIubWVzc2FnZS5zaG91bGQuZXFsKGBVbnN1cHBvcnRlZCBsb2cgdHlwZSAndGhyZWUnLiBTdXBwb3J0ZWQgdHlwZXM6IHtcIm9uZVwiOlwiRmlyc3QgbG9nc1wiLFwidHdvXCI6XCJTZWNvbmRzIGxvZ3NcIn1gKTtcbiAgICAgIFNVUFBPUlRFRF9MT0dfVFlQRVMub25lLmdldHRlci5jYWxsZWQuc2hvdWxkLmJlLmZhbHNlO1xuICAgICAgU1VQUE9SVEVEX0xPR19UWVBFUy50d28uZ2V0dGVyLmNhbGxlZC5zaG91bGQuYmUuZmFsc2U7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBjYWxsIGdldHRlciBvbiBhcHByb3ByaWF0ZSBsb2cgd2hlbiBmb3VuZCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxvZ0NvbW1hbmRzLnN1cHBvcnRlZExvZ1R5cGVzID0gU1VQUE9SVEVEX0xPR19UWVBFUztcbiAgICAgIGxldCBsb2dzID0gYXdhaXQgbG9nQ29tbWFuZHMuZ2V0TG9nKCdvbmUnKTtcbiAgICAgIGxvZ3Muc2hvdWxkLmVxbChGSVJTVF9MT0dTKTtcbiAgICAgIFNVUFBPUlRFRF9MT0dfVFlQRVMub25lLmdldHRlci5jYWxsZWQuc2hvdWxkLmJlLnRydWU7XG4gICAgICBTVVBQT1JURURfTE9HX1RZUEVTLnR3by5nZXR0ZXIuY2FsbGVkLnNob3VsZC5iZS5mYWxzZTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwibWFwcGluZ3MiOiI7Ozs7QUFDQSxJQUFBQSxJQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxLQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxlQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxNQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxPQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFHQUssYUFBSSxDQUFDQyxNQUFNLENBQUMsQ0FBQztBQUNiRCxhQUFJLENBQUNFLEdBQUcsQ0FB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
